# `v-if`、`v-show`和`v-html`的原理是什么？如何实现的？

## `v-if`

### 原理：
根据表达式的[真值-truthy](https://developer.mozilla.org/zh-CN/docs/Glossary/Truthy)来有条件地渲染元素。
### 实现：
会调用`addIfCondition`方法，在生成`vnode`的时候忽略对应节点，render的时候就不会渲染。

## `v-show`

### 原理：
根据表达式的真假值，来切换元素的`display`样式属性。

### 实现：
带`v-show`的元素会生成`vnode`，在`render`的时候也会渲染成真实元素节点，只是在`render`过程中会在节点的属性中修改`display`样式属性。

## `v-html`

### 原理：
更新元素的`innerHTML`值，**内容按普通的`HTML`插入，不会作为`Vue`模板进行编译**。单文件组件中的`scoped`样式不会应用到`v-html`内部，因为那部分`HTML`没有被`Vue`的模板编译器处理。
::: danger
在网站上动态渲染`HTML`是非常危险的，因为容易导致`XSS`攻击。只在可信的内容上使用`v-html`，永不用在用户提交的内容上。
:::

### 实现：
`v-html`会移除节点下的所有节点，调用`HTML`方法，通过`addProp`添加`innerHTML`属性，归根结底还是设置节点的`innerHTML`为`v-html`的值

## `v-if`与`v-show`

### 实现原理
* `v-if`是惰性的，如果在初始渲染时条件为假，则什么也不做——直到条件第一次变为真时，才会开始渲染对应的元素。
* `v-show`不管初始条件是什么，元素总是会被渲染。通过修改`display`的`CSS`属性来切换元素的显示与隐藏。

### 使用场景
* 在需要非常频繁地切换元素的显示与隐藏，适合使用`v-show`。
* 如果是很少切换的，则使用`v-if`比较好。

## `v-if`与`v-for`一起使用

当`v-if`与`v-for`一起使用时，`v-for`比`v-if`具有更高的优先级。`Vue`官方不推荐这两者用在同一个元素上。<br>
`
当出现两者一起用的情况，应该将列表数据替换为一个计算属性，去掉不显示的数据，返回过滤后的列表。


